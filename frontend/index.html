<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>RMNCAH</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
        integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- Tailwind CSS (with custom config using inline script) -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1e40af',   // Custom Blue
                        secondary: '#f59e0b', // Custom Amber
                        accent: '#10b981',    // Custom Green
                        dark: '#1f2937',      // Gray-800
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <link rel="stylesheet" href="styles/main.css">
    <script src="./set-base-url.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tw-elements/css/tw-elements.min.css" />
    <script src="styles/main.js"></script>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css"
        integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous" />
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@200;300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/flowbite@3.1.2/dist/flowbite.min.css" rel="stylesheet" />
    <!-- Alpine.js -->
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <!-- Leaflet JS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha384-sA+RlRzF8YK8EeQx09sEtc06CXi1K06oBJJSM6Ox9B8JeN5aZzffR28E/zTGmLXN" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha384-O3FJxqIQW2STXQKKFePx5FKP8uXpTYBJ+Al9VwZpyaXx1V4u1ZbE1cBGTSrBocjz" crossorigin=""></script>

    <!-- Auto-redirect for logged-in users -->
    <script src="auto-redirect.js"></script>

    <!-- Optional: Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
        .fade-slide-enter {
            opacity: 0;
            transform: translateY(20px);
        }

        .fade-slide-enter-active {
            opacity: 1;
            transform: translateY(0);
            transition: all 0.4s ease;
        }

        .fade-slide-leave {
            opacity: 1;
            transform: translateY(0);
        }

        .fade-slide-leave-active {
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s ease;
        }
    </style>

</head>

<body class="text-gray-800 ">
    <div class="relative h-screen bg-fixed bg-cover bg-center" id="heroSection">
        <div class="absolute inset-0 bg-black bg-opacity-50 z-0"></div>

        <div class="relative z-10 flex justify-center items-center h-full">

            <div
                class="flex flex-col w-full rounded-xl bg-white/90 backdrop-blur-xl shadow-lg max-w-3xl p-4 mx-auto items-center justify-center rounded-xl">
                <div class="flex items-center space-x-2 text-2xl font-bold text-black uppercase">
                    <img src="resources/images/moh.png" class="object-contain h-12" alt="Site Logo">
                    <img src="resources/images/log2.png" class="object-contain h-12" alt="Site Logo">
                </div>
                <p class="mt-1 text-sm opacity-70">
                    RMNCAH Coordination Hub
                </p>
                <!--Tabs navigation-->
                <ul class="mb-5 flex list-none w-full flex-row flex-wrap border-b-0 ps-0" role="tablist"
                    data-twe-nav-ref>
                    <li role="presentation" class="flex-grow basis-0 text-center">
                        <a href="#tabs-home02"
                            class="my-2 block border-x-0 border-b-2 border-t-0 border-transparent px-7 pb-3.5 pt-4 text-xs font-medium uppercase leading-tight text-neutral-500 hover:isolate hover:border-transparent hover:bg-neutral-100 focus:isolate focus:border-transparent data-[twe-nav-active]:border-primary data-[twe-nav-active]:text-primary"
                            data-twe-toggle="pill" data-twe-target="#tabs-home02" data-twe-nav-active role="tab"
                            aria-controls="tabs-home02" aria-selected="true">Login</a>
                    </li>
                    <li role="presentation" class="flex-grow basis-0 text-center">
                        <a href="#tabs-profile02"
                            class="my-2 block border-x-0 border-b-2 border-t-0 border-transparent px-7 pb-3.5 pt-4 text-xs font-medium uppercase leading-tight text-neutral-500 hover:isolate hover:border-transparent hover:bg-neutral-100 focus:isolate focus:border-transparent data-[twe-nav-active]:border-primary data-[twe-nav-active]:text-primary"
                            data-twe-toggle="pill" data-twe-target="#tabs-profile02" role="tab"
                            aria-controls="tabs-profile02" aria-selected="false">Become a Member</a>
                    </li>
                </ul>

                <!--Tabs content-->
                <div class="mb-6 w-full">
                    <div class="hidden opacity-100 transition-opacity duration-150 ease-linear data-[twe-tab-active]:block"
                        id="tabs-home02" role="tabpanel" aria-labelledby="tabs-home-tab02" data-twe-tab-active>
                        <div id="loginCard"
                            class="py-8 w-full mt-4 space-y-4 transition-all duration-500 ease-in-out rounded-xl">
                            <h2 class="text-2xl font-semibold text-center text-gray-700">Welcome Back</h2>
                            <input id="loginEmail" type="email" required placeholder="Email"
                                class="w-full px-4 py-2 border text-sm rounded-md focus:ring-2 focus:ring-blue-500">
                            <div class="flex w-full">
                                <button type="button" onclick="requestOtp()" id="loginBtn"
                                    class="w-full py-2 text-center text-white transition-all bg-blue-600 rounded-md hover:bg-blue-700">
                                    <span id="loginBtnText">Get OTP</span>
                                    <span id="loginBtnSpinner" class="hidden">
                                        <svg class="inline w-5 h-5 mr-2 text-white animate-spin"
                                            xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor"
                                                stroke-width="4">
                                            </circle>
                                            <path class="opacity-75" fill="currentColor"
                                                d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                                            </path>
                                        </svg>
                                        Sending...
                                    </span>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="hidden opacity-0 transition-opacity duration-150 ease-linear data-[twe-tab-active]:block"
                        id="tabs-profile02" role="tabpanel" aria-labelledby="tabs-profile-tab02">
                        <!-- Register Card -->
                        <div id="registerCard" class=" top-0 left-0 z-10 w-full py-8 rounded-xl">
                            <form id="registerForm" onsubmit="return validateBeforeSubmit()"
                                class="grid grid-cols-1 gap-6 md:grid-cols-2">
                                <div>
                                    <label class="block mb-1 text-sm font-medium">Full Name</label>
                                    <input type="text" id="regName" placeholder="John Doe"
                                        class="w-full px-4 py-2 border rounded-md bg-gray-50">
                                </div>
                                <div>
                                    <label class="block mb-1 text-sm font-medium">Email Address</label>
                                    <input type="email" id="regEmail" placeholder="email@example.com"
                                        class="w-full px-4 py-2 border rounded-md bg-gray-50">
                                </div>
                                <div>
                                    <label class="block mb-1 text-sm font-medium">Organization</label>
                                    <input type="text" id="regOrganization" placeholder="Company or School"
                                        class="w-full px-4 py-2 border rounded-md bg-gray-50">
                                </div>
                                <div>
                                    <label class="block mb-1 text-sm font-medium">Account Type</label>
                                    <select id="regAccountType" class="w-full px-4 py-2 border rounded-md bg-gray-50">
                                        <option value="PARTNER">Partner Organization</option>
                                        <option value="DONOR">Donor Organization</option>
                                    </select>
                                </div>
                                <div id="parentDonorSection" class="hidden md:col-span-2">
                                    <label class="block mb-1 text-sm font-medium">Parent Donor ID (Optional)</label>
                                    <input type="number" id="regParentDonorId"
                                        placeholder="Enter donor ID if linking to existing donor"
                                        class="w-full px-4 py-2 border rounded-md bg-gray-50">
                                    <p class="text-sm text-gray-600 mt-1">Leave empty if this is a standalone partner
                                        account
                                    </p>
                                </div>


                                <div class="gap-4 md:col-span-2 mt-6 space-x-4">
                                    <button type="submit" id="registerBtn"
                                        class="px-6 py-2 font-bold text-white w-full bg-blue-600 rounded hover:bg-blue-700">
                                        <span id="registerBtnText">Create Account</span>
                                        <span id="registerBtnSpinner" class="hidden">
                                            <svg class="inline w-5 h-5 mr-2 text-white animate-spin"
                                                xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor"
                                                    stroke-width="4">
                                                </circle>
                                                <path class="opacity-75" fill="currentColor"
                                                    d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                                                </path>
                                            </svg>
                                            Creating...
                                        </span>
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="flex flex-col  w-full max-w-lg p-4 mx-auto items-center justify-center ">

                </div>


            </div>
        </div>
    </div>

    <script>
        const images = [
            'resources/images/main-1.jpg',
            'resources/images/main-2.jpg',
            'resources/images/main-3.jpg'
        ];

        const randomImage = images[Math.floor(Math.random() * images.length)];
        document.getElementById('heroSection').style.backgroundImage = `url('${randomImage}')`;
    </script>



    <script>
        async function requestOtp() {
            const email = document.getElementById("loginEmail").value;
            if (!email) return alert("Please enter your email");

            // Show loading state
            const btn = document.getElementById("loginBtn");
            const btnText = document.getElementById("loginBtnText");
            const btnSpinner = document.getElementById("loginBtnSpinner");

            btn.disabled = true;
            btn.classList.add("opacity-75", "cursor-not-allowed");
            btnText.classList.add("hidden");
            btnSpinner.classList.remove("hidden");

            // Request OTP from backend
            try {
                const apiBase = (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1")
                    ? "https://tujulishane-hub-backend-52b7e709d99f.herokuapp.com"
                    : "https://tujulishane-hub-backend-52b7e709d99f.herokuapp.com";
                const res = await fetch(`${apiBase}/api/auth/login`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ email })
                });

                const data = await res.json();
                if (!res.ok) throw new Error(data.message || "Login failed");

                alert("OTP sent to your email. Please check your inbox.");
                localStorage.setItem("pendingEmail", email);
                localStorage.setItem("isLogin", "true");
                window.location.href = "otp.html";
            } catch (err) {
                alert(err.message || "Failed to send OTP");

                // Reset button state on error
                btn.disabled = false;
                btn.classList.remove("opacity-75", "cursor-not-allowed");
                btnText.classList.remove("hidden");
                btnSpinner.classList.add("hidden");
            }
        }
    </script>
    <script>
        async function validateBeforeSubmit() {
            const name = document.getElementById("regName").value;
            const email = document.getElementById("regEmail").value;
            const accountType = document.getElementById("regAccountType").value;
            const parentDonorId = document.getElementById("regParentDonorId").value;

            // Show loading state
            const btn = document.getElementById("registerBtn");
            const btnText = document.getElementById("registerBtnText");
            const btnSpinner = document.getElementById("registerBtnSpinner");

            btn.disabled = true;
            btn.classList.add("opacity-75", "cursor-not-allowed");
            btnText.classList.add("hidden");
            btnSpinner.classList.remove("hidden");

            try {
                const apiBase = (window.location.hostname === "localhost" || window.location.hostname === "127.0.0.1")
                    ? "https://tujulishane-hub-backend-52b7e709d99f.herokuapp.com"
                    : "https://tujulishane-hub-backend-52b7e709d99f.herokuapp.com";

                const payload = { name, email, accountType };
                if (accountType === "PARTNER" && parentDonorId) {
                    payload.parentDonorId = parseInt(parentDonorId);
                }

                const res = await fetch(`${apiBase}/api/auth/register`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(payload)
                });

                const data = await res.json();
                if (!res.ok) throw new Error(data.message || "Registration failed");

                alert("Registration successful! Check your email for the OTP.");
                localStorage.setItem("pendingEmail", email);
                window.location.href = "otp.html";
            } catch (err) {
                alert(err.message);

                // Reset button state on error
                btn.disabled = false;
                btn.classList.remove("opacity-75", "cursor-not-allowed");
                btnText.classList.remove("hidden");
                btnSpinner.classList.add("hidden");
            }

            return false;
        }

    </script>



    </div>

    <script src="https://cdn.jsdelivr.net/npm/tw-elements/js/tw-elements.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flowbite@3.1.2/dist/flowbite.min.js"></script>
    <!-- Leaflet JS -->


</body>

</html>